<!DOCTYPE html>
<head>
  <title>Pantone colors</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body {
      margin: auto 16px;
      color: white;
      background-color: #444;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    h1 {
      text-align: center;
    }
    div, span, input, button { font-size: 16px;}
    #container {
      display: flex;
      flex-flow: row wrap;
      gap: 8px;
      justify-content: center;
    }
    article {
      width: 150px;
    }
    .color {
      height: 30px;
      display: block;
    }
    form {
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 8px;
      align-items: center;
    }
    form input {
      width: 308px;
    }
    a { color: inherit }
  </style>
</head>
<body>
  <h1>Pantone color names</h1>
  <form>
    <div>
      <input autofocus type="search" placeholder="Search ..." name="search" />
    </div>
    <div>
      <button>search</button>
      <a href="?random=true">
        <button type="button">random</button>
      </a>
      <button type="button" onclick="event.target.nextElementSibling.click();">pick</button>
      <input type="color" style="display: none;" value="#36309a" onchange="window.location.href='?pick='+this.value.replace('#', '')"/>
    </div>
  </form>
  <div id="container"></div>
  <template>
    <article>
      <a class="color"></a>
      <span class="name"></span>
    </article>
  </template>
</body>
<script type="module">
  let colors = await fetch('https://unpkg.com/color-name-list').then(r => r.json()) // Array<{name:string, hex:string}>
  const kebabCase = (str) => (str.match(/[A-Z]?[a-z]+[0-9]*|[A-Z]+[0-9]*|[0-9]+/g) || []).join("-").toLowerCase();

  const qs = new URLSearchParams(window.location.search);
  const search = qs.get("search");
  const random = qs.get("random");
  const pick = qs.get("pick");

  if(random) {
    colors = colors.sort(() => Math.random() - 0.5)
  } else if(search){
    colors = colors
      .filter(({name}) => kebabCase(name).includes(kebabCase(search)))
      .sort((a, b) => a.name.localeCompare(b.name))
    document.querySelector('input[type=search]').value = search || ''
  } else if (pick){
    const coord = (c) => [Number('0x'+c[1]+c[2]), Number('0x'+c[3]+c[4]), Number('0x'+c[5]+c[6])]
    const dist = (coordA, coordB) => Math.sqrt(
      (coordA[0] - coordB[0]) ** 2 +
      (coordA[1] - coordB[1]) ** 2 +
      (coordA[2] - coordB[2]) ** 2
    )
    const pickCoord = coord('#'+pick)
     document.body.style.backgroundColor='#'+pick
    colors = colors
      .map(e => ({...e, dist: dist(coord(e.hex), pickCoord) }))
      .sort((a, b) => a.dist - b.dist)
      .filter(c => c.dist <= 30)
  }
  const container = document.getElementById("container");
  const template = document.getElementsByTagName("template")[0];

  colors.slice(0, 100).forEach(({name, hex, dist}) => {
    const el = template.content.cloneNode(true);
    el.querySelector(".color").href="?pick="+hex.replace('#', '')
    el.querySelector(".color").style.backgroundColor = hex;
    el.querySelector(".name").innerHTML = name;
    container.appendChild(el);
  });
</script>
